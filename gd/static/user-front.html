<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>GDv1 · Panel interactivo</title>
  <link rel="icon" type="image/svg+xml" href="/static/telefonica-favicon.svg" />
  <link rel="stylesheet" href="/static/user-front.css" />
</head>
<body>
  <header class="hero">
    <div class="hero__content">
      <p class="eyebrow">GDv1 heritage · API operable</p>
      <h1>Panel interactivo Codex</h1>
      <p class="lead">
        Opera la API local (puerto 8000) con una interfaz inspirada en el cuaderno original.
        Crea proyectos, consulta dependencias, revisa métricas y envía sugerencias sin salir del navegador.
      </p>
      <div class="hero__actions">
        <a class="btn" href="/docs">Abrir Swagger UI</a>
        <button class="btn ghost" id="btn-health">Actualizar estado</button>
      </div>
      <div class="badges">
        <span class="badge">Localhost:8000</span>
        <span class="badge">Excel corporativo</span>
        <span class="badge">Compatibilidad GDv1</span>
      </div>
    </div>
    <div class="hero__card" id="health-panel">
      <p class="label">Estado del backend</p>
      <div class="status status--idle">Esperando prueba…</div>
      <p class="small">Usa el botón "Actualizar estado" para verificar rutas y archivos activos.</p>
      <pre class="mono" id="health-json"></pre>
    </div>
  </header>

  <main class="layout">
    <section class="panel">
      <div class="panel__header">
        <div>
          <p class="label">Catálogos</p>
          <h2>Mapa de dependencias</h2>
          <p class="muted">Consulta rápida de catálogos activos y su cobertura de dependencias.</p>
        </div>
        <button class="chip" id="btn-load-catalogs">Refrescar</button>
      </div>
      <div class="grid" id="catalog-grid"></div>
      <pre class="mono" id="catalog-json"></pre>
    </section>

    <section class="panel">
      <div class="panel__header">
        <div>
          <p class="label">Proyectos</p>
          <h2>Consulta puntual</h2>
          <p class="muted">Introduce el nombre tal como aparece en la hoja <code>ProyectosTI</code>.</p>
        </div>
        <div class="inline-form">
          <input id="project-name" type="text" placeholder="Nombre del proyecto" />
          <button class="btn" id="btn-fetch-project">Buscar</button>
        </div>
      </div>
      <div class="result" id="project-result"></div>
    </section>

    <section class="panel two-col">
      <div>
        <div class="panel__header">
          <div>
            <p class="label">Actualización</p>
            <h2>Actualizar fila</h2>
            <p class="muted">Modifica avance, estimado y dependencias de una fila específica.</p>
          </div>
        </div>
        <form class="form" id="update-form">
          <label>Fila en Excel <input type="number" id="update-row" min="2" required /></label>
          <label>Avance (%) <input type="number" step="0.01" id="update-avance" /></label>
          <label>Estimado (%) <input type="number" step="0.01" id="update-estimado" /></label>
          <label>Dependencias (una por línea: Equipo|P/L|Descripción)
            <textarea id="update-deps" rows="4" placeholder="Plataforma Core|P|Pendiente por aprobación"></textarea>
          </label>
          <button class="btn" type="submit">Aplicar cambios</button>
        </form>
        <pre class="mono" id="update-response"></pre>
      </div>
      <div>
        <div class="panel__header">
          <div>
            <p class="label">Alta rápida</p>
            <h2>Registrar nuevo proyecto</h2>
            <p class="muted">Crea un nuevo registro con dependencias básicas.</p>
          </div>
        </div>
        <form class="form" id="create-form">
          <label>Nombre <input id="create-nombre" required /></label>
          <label>Responsable <input id="create-responsable" /></label>
          <label>Estado <input id="create-estado" placeholder="En curso / En espera" /></label>
          <label>Q radicado <input id="create-q" /></label>
          <label>Dependencias (una por línea: Equipo|P/L|Descripción)
            <textarea id="create-deps" rows="4" placeholder="Canales Digitales|L|Listo"></textarea>
          </label>
          <button class="btn" type="submit">Crear proyecto</button>
        </form>
        <pre class="mono" id="create-response"></pre>
      </div>
    </section>

    <section class="panel two-col">
      <div>
        <div class="panel__header">
          <div>
            <p class="label">Métricas</p>
            <h2>Vista ejecutiva</h2>
            <p class="muted">Explora KPIs agregados por catálogo activo.</p>
          </div>
          <div class="inline-form">
            <select id="metrics-scope">
              <option value="all">Global</option>
              <option value="tren">Por Tren</option>
              <option value="celula">Por Célula</option>
            </select>
            <input id="metrics-filter" placeholder="Nombre de tren/célula (opcional)" />
            <button class="btn ghost" id="btn-metrics">Calcular</button>
          </div>
        </div>
        <div class="result" id="metrics-result"></div>
      </div>
      <div>
        <div class="panel__header">
          <div>
            <p class="label">Feedback</p>
            <h2>Enviar sugerencia</h2>
            <p class="muted">Se almacena en la hoja <code>Sugerencias</code> como en el notebook.</p>
          </div>
        </div>
        <form class="form" id="suggest-form">
          <label>Usuario / Squad <input id="suggest-usuario" placeholder="Squad Data" /></label>
          <label>Mensaje
            <textarea id="suggest-texto" rows="4" required placeholder="Descripción breve de la mejora"></textarea>
          </label>
          <button class="btn" type="submit">Enviar</button>
        </form>
        <div class="result" id="suggest-result"></div>
      </div>
    </section>
  </main>

  <footer class="footer">
    <p>Construido sobre la API FastAPI en <strong>http://localhost:8000</strong>. Compatible con el flujo GDv1.</p>
  </footer>

  <script src="/static/user-front.js"></script>
</body>
</html>
